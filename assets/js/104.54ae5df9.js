(window.webpackJsonp=window.webpackJsonp||[]).push([[104],{510:function(t,n,e){"use strict";e.r(n);var p=e(2),r=Object(p.a)({},(function(){var t=this,n=t._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("p",[t._v("操作Zip\n最后更新: 2019/8/14 22:48 / 阅读: 790559\nZipInputStream是一种FilterInputStream，它可以直接读取zip包的内容：")]),t._v(" "),n("p",[t._v("┌───────────────────┐\n│    InputStream    │\n└───────────────────┘\n▲\n│\n┌───────────────────┐\n│ FilterInputStream │\n└───────────────────┘\n▲\n│\n┌───────────────────┐\n│InflaterInputStream│\n└───────────────────┘\n▲\n│\n┌───────────────────┐\n│  ZipInputStream   │\n└───────────────────┘\n▲\n│\n┌───────────────────┐\n│  JarInputStream   │\n└───────────────────┘\n另一个JarInputStream是从ZipInputStream派生，它增加的主要功能是直接读取jar文件里面的MANIFEST.MF文件。因为本质上jar包就是zip包，只是额外附加了一些固定的描述文件。")]),t._v(" "),n("p",[t._v("读取zip包\n我们来看看ZipInputStream的基本用法。")]),t._v(" "),n("p",[t._v("我们要创建一个ZipInputStream，通常是传入一个FileInputStream作为数据源，然后，循环调用getNextEntry()，直到返回null，表示zip流结束。")]),t._v(" "),n("p",[t._v("一个ZipEntry表示一个压缩文件或目录，如果是压缩文件，我们就用read()方法不断读取，直到返回-1：")]),t._v(" "),n("p",[t._v("try (ZipInputStream zip = new ZipInputStream(new FileInputStream(...))) {\nZipEntry entry = null;\nwhile ((entry = zip.getNextEntry()) != null) {\nString name = entry.getName();\nif (!entry.isDirectory()) {\nint n;\nwhile ((n = zip.read()) != -1) {\n...\n}\n}\n}\n}\n写入zip包\nZipOutputStream是一种FilterOutputStream，它可以直接写入内容到zip包。我们要先创建一个ZipOutputStream，通常是包装一个FileOutputStream，然后，每写入一个文件前，先调用putNextEntry()，然后用write()写入byte[]数据，写入完毕后调用closeEntry()结束这个文件的打包。")]),t._v(" "),n("p",[t._v("try (ZipOutputStream zip = new ZipOutputStream(new FileOutputStream(...))) {\nFile[] files = ...\nfor (File file : files) {\nzip.putNextEntry(new ZipEntry(file.getName()));\nzip.write(Files.readAllBytes(file.toPath()));\nzip.closeEntry();\n}\n}\n上面的代码没有考虑文件的目录结构。如果要实现目录层次结构，new ZipEntry(name)传入的name要用相对路径。")]),t._v(" "),n("p",[t._v("小结\nZipInputStream可以读取zip格式的流，ZipOutputStream可以把多份数据写入zip包；")]),t._v(" "),n("p",[t._v("配合FileInputStream和FileOutputStream就可以读写zip文件。")])])}),[],!1,null,null,null);n.default=r.exports}}]);